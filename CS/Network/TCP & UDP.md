### TCP(Transmission Control Protocol)란?

- 연결 지향적 프로토콜로 장치들 사이에서 논리적인 접속을 성립하기 위해 연결을 설정해 신뢰성을 보장하는 보장하는 프로토콜
- TCP는 네트워크에 연결된 컴퓨터에서 실행되는 프로그램 간에 일련의 옥텟(데이터, 메시지, 세그먼트라는 블록 단위)을 안정적으로, 순서대로, 에러 없이 교환 하도록 보장

### TCP의 특징

- 연결 지향 방식으로 패킷 교환 방식을 사용
    - 패킷을 전송하기 위한 논리적 접속(세션)을 생성
    - 3-way handshaking 과정을 통해 연결을 설정하고, 4-way handshaking 과정을 통해 연결을 해제
- 흐름 제어(Flow control)
    - 데이터 처리 속도를 조절하여 수신자의 버퍼 오버플로우를 방지
- 혼잡 제어(Congestion control)
    - 네트워크 내의 패킷 수가 과도하게 증가하지 않도록 방지
- 높은 신뢰성을 보장
    - 신뢰성을 높이기 위해 연결 지향 방식을 사용하기 때문에 UDP 보다 속도가 느림
- 전이중(Full-Duplex), 점대점(Point to Point) 방식
    - 전이중(Full-Duplex) : 전송이 양방향으로 동시에 일어날 수 있다.
    - 점대점(Point to Point) : 각 연결이 정확히 2개의 종단점을 가지고 있다.

### UDP(User Datagram Protocol)란?

- 데이터를 데이터그램 단위로 처리하는 프로토콜
- 비연결형, 신뢰성 없는 프로토콜
- 데이터그램 단위로 쪼개면서 전송을 해야하기 때문에 전송 계층
- 전송 계층에서 사용하는 프로토콜

### **UDP의 특징**

- 비연결형 서비스로 데이터그램 방식을 제공하며 데이터 수신 여부를 확인하지 않음
    - 데이터의 전송 순서가 바뀔 수 있으며 TCP와 같이 3-way-handshaking 과정이 없기 때문에 데이터의 수신 여부를 알 수 없음
- 신뢰성이 낮음
    - 흐름 제어가 없어서 제대로 전송되었는지, 오류가 없는지 확인할 수 없음
- TCP보다 속도가 빠름
    - 비연결성으로 3-way-handshaking 과정과 흐름제어 혼잡제어 등의 기능을 처리하지 않기 때문에 속도가 빠름

### UDP를 사용하는 이유?

- 데이터의 신속성(데이터의 처리 속도가 TCP보다 빠름)
- 3 way handshaking으로 연결을 유지할 필요가 없음(비연결성)
- Request의 양이 적음
- 신뢰성보다는 연속성 있는 전송이 필요할 때 사용하는 프로토콜로 실시간 서비스(streaming)에 자주 사용
- HTTP 3.0 버전에서는 TCP를 사용하지 않고 UDP를 사용한 QUIC(Quick UDP Internet Connections)을 채택하여 더 빠르게 통신을 하도록 함

### QUIC(Quick UDP Internet Connections)란?

- UDP를 기반으로 TCP + TLS + HTTP 의 기능을 모두 구현하는 프로토콜
- TCP를 사용하지 않기 때문에 3-way-handshake 과정을 거치지 않음

### QUIC의 장점

1. RTT(Round Trip Time) 감소
    - RTT는 클라이언트가 보낸 요청을 서버가 처리한 후 다시 클라이언트로 응답해주는 사이클
    - 기존 TLS+TCP에서는 TLS 연결을 위한 핸드셰이크와 TCP를 위한 핸드셰이크가 각각 발생했지만 QUIC에서는 이를 한단계로 줄임
    - TLS+TCP는 세션키를 주고 받고 암호화된 연결을 성립한 후에 세션키와 함께 데이터를 교환하였지만 QUIC는 프로토콜 내에 TLS를 포함하여 데이터 전달과 암호화 절차가 동시에 수행
    - QUIC는 연결 식별자(Connection Identifier)로 Connection ID를 사용 (TCP는 IP, Port를 사용), 클라이언트는 Connect ID를 사용하여 Initail Key를 생성하고 이를 데이터와 함께 전송하고 한번 연결에 성공하면 서버는 그 설정을 캐싱해놓고 있다가, 다음 연결 때는 캐싱해놓은 설정을 사용하여 바로 연결을 성립시키기 때문에 0RTT로 통신이 가능해짐
2. HOL(Head-of-Line) Blocking 최소화
    
    ![HOLB](https://github.com/juhwan-Ki/TIL/assets/87765888/daa9ca91-72c2-4659-bc83-d731f799354a)
    
    - TCP의 바이트스트림 추상화는 모든 데이터를 단일 파일의 일부로 간주하기 때문에 단일 TCP 패킷 손실은 여러 전송 중인 리소스에 대한 데이터를 지연
    - 위 첫번째 두번째 스트림 그림처럼 한개의 손실만 일어나도 뒤에 있는 모든 데이터들이 지연되거나 전송이 안될 수 있음
    - 반면에 QUIC는 여러 개의 동시 바이트스트림이 있고 스트림별로 손실을 처리하기 때문에 해당 손실외에 다른 데이터들은 정상적으로 전달
3. 네트워크가 바뀌어도 연결이 유지
    - TCP는 연결을 4-tuple(Source IP, Source Port, Destination IP, Destination Port)로 식별
    - 스마트폰으로 인터넷을 하다가 네트워크가 셀룰러에서 와이파이로 바뀌면 클라이언트의 IP가 바뀌기 때문에 연결이 끊어지는 것!
    - 다른 조건이 동일하더라도 새 연결을 설정하려면 새로운 TCP(및 TLS) 핸드셰이크를 실행해야함! 네트워크가 바뀌면 일시적으로 지연이 발생하는 이유가 이 이유임!
    - 반면 QUIC은 Connection ID를 사용하여 서버와 연결을 생성하고 Connection ID는 랜덤한 값일 뿐, 클라이언트의 IP와는 전혀 무관한 데이터이기 때문에 클라이언트의 IP가 변경되더라도 기존의 연결을 계속 유지할 수 있음!! 이는 새로 연결을 생성할 때 거쳐야하는 핸드쉐이크 과정을 생략 가능하게 함
    
    ### QUIP의 단점
    
    - 존에 암호화하지 않고 있던 헤더 필드 영역까지 암호화하게 됨에 따라, 혹은 등의 정보에 쉽게 접근할 수 없음 이런 헤더의 정보를 사용하는 ISP나 네트워크 중계회사들은 QUIC을 도입하는데 주저함
    - QUIC은 패킷별로 암호화를 하기 때문에 기존의 TLS-TCP에서 패킷을 묶어서 암호화하는 것보다 더 큰 리소스 소모를 불러올 수 있다는 단점이 있음