### IPC

- 프로세스는 독립적인 메모리를 가지기 때문에 다른 프로세스에서 해당 메모리를 참조할 수 없게 되어 있다 이러한 문제를 해결하기 위해서 IPC(Inter Process Communication)을 통해 프로세스간 통신을 진행한다
- IPC는 커널이 제공하는 IPC 설비를 이용해 프로세스간 통신을 할 수 있다
- IPC의 종류로는 공유 메모리 모델과 메세지 전달 모델로 나뉜다

### 공유 메모리 모델
- 두 개 이상의 프로세스들이 주소 공간의 일부를 공유하여 공유한 메모리 영역에 읽기/쓰기를 통해 통신을 수행한다
- 프로세스가 공유 메모리 할당을 커널에 요청하면 커널은 해당 프로세스에 메모리 공간을 할당해 주게 되고 공유 메모리가 설정되면 공유된 메모리를 사용하여 커널의 관여 없이 통신이 가능해진다
- 커널의 관여 없이 메모리를 사용하여 IPC 속도가 빠르다는 장점이 있지만 데이터를 읽어야할 시점을 알 수 없고 동기화 문제가 발생 할 수 있어 별도의 동기화 처리가 필요하다

### 메시지 전달 모델
- 커널 메모리 영역에 메세지를 전달할 수 있는 영역을 만들어서 협력하는 프로세스 사이에 메시지 형식으로 송/수신 하는 방식이다
- 커널을 경유하여 메시지를 송/수신하고 프로세스간 메모리 공유 없이 사용이 가능하다
- 커널에서 데이터를 주고 받는 것을 관리하기 때문에 동기화 로직이 필요없다는 장점이 있지만 커널을 통해 주고 받기 때문에 공유 메모리 보다 느리다는 단점이 있다

- 메시지 전달 모델 종류
    - 익명 파이프
        - 파이프는 단방향 통신 채널로 두 개의 프로세스를 하나의 파이프로 연결하여 하나의 프로세스는 쓰기만 하고 다른 프로세스는 읽기만 할 수 있다 
        - 따라서 양쪽 다 송/수신을 하기 위해서는 파이프를 두 개 만들어야 한다(송신용 1개 수신용 1개)
        - 용량 제한이 있고 read()와 write()가 기본적으로 block mode로 작동되기에 프로세스가 read 대기중이라면 read가 끝나기전에는 write를 할 수 없다
        - 주로 부모 프로세스와 자식 프로세스 간의 통신에 사용된다
        - 장점
            - 간단하게 사용할 수 있다(단순한 흐름이기 때문)
        - 단점
            - 전이중(Full-Duplex) 통신 방식으로 통신하려면 파이프를 2개 만들어야 하여 구현이 복잡해질 수 있다
            - 버퍼가 상대적으로 작기 때문에 overflow될 확률이 높다(read를 빨리 처리해야함)
    
    - Named 파이프(FIFO)
        - 익명 파이프는 통신할 프로세스를 명확히 알 수 있는 경우에 사용된다(부모-자식 프로세스 처럼)
        - Named 파이프는 부모 프로세스와 무관한 다른 프로세스도 통신이 가능하다(이름이 있는 파일 사용)
        - Named 파이프 역시 읽기/쓰기 동시에 불가능하며 따라서 전이중 통신을 위해서는 익명 파이프처럼 파이프를 2개를 만들어야 가능하다

    - 메시지 큐
        - 메세지 큐는 데이터를 임시로 저장하는 버퍼 메모리로 사용할 데이터의 번호를 붙여서 다른 프로세스에서 데이터를 사용할 수 있도록 하는 방식으로 양방향 통신이 가능하다
        - 메세지 큐는 메모리를 사용하기 때문에 데이터가 많아지면 추가적인 메모리 자원이 필요하며 큐에서 데이터를 넣고 찾는 과정에서 오버헤드가 발생한다
        - 장점
            - 비동기 방식이기에 방대한 처리량이 있다면 큐에 넣은 후 나중에 처리 할 수 있다
            - 다수의 프로세스들이 큐에 메시지를 보낼 수 있고 다수의 프로세스들이 큐로부터 메시지를 꺼낼 수 있다
            - 분산처리 및 경쟁처리 방식에 사용할 수 있다
        - 단점
            - 메시지가 정말 잘 전달되었는지 알 수 없다
            - 큐에 데이터를 넣고 나오는 과정에서 오버헤드가 발생 할 수 있다
            - 데이터가 많이 쌓일수록 추가적인 메모리 자원이 필요하다
    - 소켓
        - 네트워크 소켓을 이용하여 Client - Server 구조로 데이터 통신을 하며, 원격에서 프로세스 간 데이터를 공유할 때 사용한다
        - 프로세스는 포트 번호를 이용하여 통신하려는 상대 프로세스의 소켓을 찾는다
        - 포트의 도움으로, 다른 IPC와 달리 프로세스의 위치에 독립적이며, 다른 IPC는 모두 local에서만 사용할 수 있는 반면, Machine Boundary와 관계가 없기 때문에 Local 또는 Remote로 사용할 수 있다

    >💡익명 파이프 VS Named 파이프
    
    익명 파이프는 데이터 통신을 할 프로세스가 명확하게 알 수 있을 때 사용<br>
    송신할 프로세스는 수신할 프로세스를 알고, 수신할 프로세스는 송신할 프로세스를 아는 경우
    
    가장 대표적인 예가 부모프로세스와 자식프로세스간에 데이터 통신을 하고자 할 때 부모 프로세스와 자식 프로세스는 서로를 명확히 알고 있으므로 굳이 파이프에 이름을 줄 필요가 없을 것이다

    반면, 자식과 부모 관계가 아닌 전혀 모르는 프로세스들 사이에서 파이프를 이용해서 통신을 해야하는 경우는 우리가 생판 모르는 사람과 대화를 하려면 이름을 알아야 하듯 파이프에 이름을 주어져야 한다 그것이 Named 파이프를 만든 이유이다

