## Multi process/thread 환경에서 동기화 문제 해결

- 동기화 문제란 공유 자원에 동시에 여러 프로세스나 스레드가 접근하여 엉뚱한 값을 일거나 수정하는 문제를 말한다.
- 이러한 문제를 해결하기 위해서는 mutex나 semaphore를 통해 해결할 수 있다.

### 임계영역(critical section)

- 둘 이상의 process/thread가 동시에 동일한 자원에 접근하도록 하는 프로그램 코드 부분을 의미한다. 중요한 특징중 하나는, 한 process/thread가 자신의 임계구역에서 수행하는 동안에는 다른 process/thread들은 그들의 임계구역에 들어갈 수 없어야 한다는 사실이다. 즉, 임계영역 내의 코드는 원자적으로(atomically) 실행이 되어야 한다.

- 원자적으로 실행 되기 위해서 각각의 process/thread는 자신의 임계구역으로 진입하려면 진입 허가를 요청해야 한다. 이 부분을 entry section이라고 하고, 진입이 허가되면 임계영역을 실행할 수 있다. 임계영역이 끝나고 나면 exit section으로 퇴출을 하게 된다. 임계영역의 원자성을 보장하여 process/thread들이 동기화되도록 할 수 있다.

### Mutex
- mutex는 1개의 스레드만 공유 자원에 접근하도록 하여 동기화 문제를 해결하는 방식이다.
- 공유 자원을 점유하는 스레드가 lock을 걸면, 다른 thread는 unlock 상태가 될 때까지 해당 자원에 접근할 수 없다.

### Semaphore
- semaphore는 S개의 스레드만 공유 자원에 접근하도록 하여 동기화를 해결하는 방식이다.
- 정수형 변수 S(세마포) ****값을 가용한 자원의 수로 초기화하고, 자원에 접근할 때는 `S--` 연산을 수행하여 세마포 값을 감소시키고 자원을 방출할 때는 `S++` 연산을 수행하여 세마포 값을 증가시킨다. 이 때 세마포 값이 0이 되면 모든 자원이 사용 중임을 의미하고, 이후 자원을 사용하려는 프로세스는 세마포 값이 0보다 커질 때까지 block 된다.